---
title: Ã‰tape 6 - Theming Drupal
description: CrÃ©er un thÃ¨me personnalisÃ© avec Twig, CSS et JavaScript
sidebar:
  order: 0

# status: stable
# last-reviewed: 2026-01-14
---

import { Card, CardGrid } from '@astrojs/starlight/components';

<div class="duration-badge">â±ï¸ DurÃ©e estimÃ©e : 5h</div>

## ğŸ¯ Objectifs de cette Ã©tape

Ã€ la fin de cette Ã©tape, vous serez capable de :

- âœ… CrÃ©er un thÃ¨me personnalisÃ© Drupal
- âœ… Comprendre le systÃ¨me de templates Twig
- âœ… Personnaliser l'affichage du contenu
- âœ… Ajouter des CSS et JavaScript au thÃ¨me
- âœ… IntÃ©grer Tailwind CSS dans Drupal
- âœ… Utiliser Alpine.js pour les interactions

## ğŸ“‹ PrÃ©requis

- [x] Ã‰tape 5 terminÃ©e (navigation, blocs, menus)
- [x] **HTML/CSS** : Structure sÃ©mantique, flexbox/grid, responsive design
- [x] **Twig** : Notion de templating (sera approfondi dans cette Ã©tape)
- [x] Template TailStore analysÃ© (rÃ©fÃ©rence visuelle depuis l'Ã‰tape 1)
- [x] Node.js >= 18.x et npm >= 9.x installÃ©s (pour Tailwind/Alpine.js)

## ğŸ§° Avant de commencer

### VÃ©rifier votre environnement

```bash
# Node.js et npm (pour Tailwind/Alpine)
node --version  # >= 18.x
npm --version   # >= 9.x

# Composer (pour dÃ©pendances Drupal)
composer --version  # >= 2.x

# Drush
drush --version  # >= 12.x
```

### CrÃ©er un backup de sÃ©curitÃ©

```bash
# Sauvegarder la base de donnÃ©es avant modifications
drush sql:dump > backup-avant-etape6.sql

# En cas de problÃ¨me, restaurer avec :
# drush sql:cli < backup-avant-etape6.sql
```

### Activer le mode dÃ©veloppement

```bash
# DÃ©sactiver le cache pour voir les modifications en temps rÃ©el
drush state:set system.performance css_preprocess 0 --input-format=string
drush state:set system.performance js_preprocess 0 --input-format=string
drush cr
```

## ğŸ“š Sommaire

**Approche progressive** : Nous suivrons une mÃ©thodologie logique â€” d'abord la structure du thÃ¨me, puis les outils (CSS/JS), ensuite les templates Twig pour personnaliser l'affichage, et enfin l'interactivitÃ© avec Alpine.js.

<CardGrid>
  <Card title="1. CrÃ©er un thÃ¨me" icon="setting">
    Structure et fichiers de base d'un thÃ¨me.
    [Voir â†’](/etape-6-theming/creation-theme/)
  </Card>
  <Card title="2. Templates Twig" icon="document">
    Personnaliser l'affichage avec Twig.
    [Voir â†’](/etape-6-theming/twig/)
  </Card>
  <Card title="3. Assets (CSS/JS)" icon="puzzle">
    Ajouter des librairies CSS et JavaScript.
    [Voir â†’](/etape-6-theming/assets/)
  </Card>
  <Card title="4. Tailwind CSS" icon="seti:css">
    IntÃ©grer Tailwind CSS v4 dans Drupal.
    [Voir â†’](/etape-6-theming/tailwind/)
  </Card>
  <Card title="5. Alpine.js" icon="rocket">
    Ajouter des interactions dynamiques.
    [Voir â†’](/etape-6-theming/alpinejs/)
  </Card>
</CardGrid>

## ğŸ—ï¸ Architecture du thÃ¨me TailStore

### Structure de fichiers

```
themes/custom/tailstore/
â”œâ”€â”€ tailstore.info.yml          # DÃ©claration du thÃ¨me
â”œâ”€â”€ tailstore.libraries.yml      # CSS et JS
â”œâ”€â”€ tailstore.theme              # Fonctions PHP
â”œâ”€â”€ tailstore.breakpoints.yml    # Points de rupture responsive
â”‚
â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ base/
â”‚   â”‚   â”œâ”€â”€ reset.css
â”‚   â”‚   â””â”€â”€ typography.css
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ buttons.css
â”‚   â”‚   â”œâ”€â”€ cards.css
â”‚   â”‚   â”œâ”€â”€ forms.css
â”‚   â”‚   â””â”€â”€ navigation.css
â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”œâ”€â”€ grid.css
â”‚   â”‚   â””â”€â”€ regions.css
â”‚   â””â”€â”€ tailstore.css            # Import principal
â”‚
â”œâ”€â”€ js/
â”‚   â”œâ”€â”€ tailstore.js             # Scripts principaux
â”‚   â”œâ”€â”€ cart.js                  # Panier
â”‚   â””â”€â”€ slider.js                # Carousel
â”‚
â”œâ”€â”€ images/
â”‚   â”œâ”€â”€ logo.svg
â”‚   â””â”€â”€ icons/
â”‚
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ layout/
â”‚   â”‚   â”œâ”€â”€ page.html.twig
â”‚   â”‚   â””â”€â”€ region.html.twig
â”‚   â”œâ”€â”€ block/
â”‚   â”‚   â”œâ”€â”€ block.html.twig
â”‚   â”‚   â””â”€â”€ block--system-branding-block.html.twig
â”‚   â”œâ”€â”€ node/
â”‚   â”‚   â”œâ”€â”€ node.html.twig
â”‚   â”‚   â”œâ”€â”€ node--product.html.twig
â”‚   â”‚   â”œâ”€â”€ node--product--teaser.html.twig
â”‚   â”‚   â””â”€â”€ node--product--card.html.twig
â”‚   â”œâ”€â”€ field/
â”‚   â”‚   â””â”€â”€ field--field-price.html.twig
â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â””â”€â”€ views-view--products-catalog.html.twig
â”‚   â””â”€â”€ misc/
â”‚       â”œâ”€â”€ pager.html.twig
â”‚       â””â”€â”€ breadcrumb.html.twig
â”‚
â””â”€â”€ config/
    â””â”€â”€ install/
        â””â”€â”€ tailstore.settings.yml
```

## ğŸ¨ Design System TailStore

### Tokens CSS (Design Tokens)

ğŸ’¡ **Pourquoi des tokens ?**
- Centraliser les valeurs de design (couleurs, espacements, typographie)
- Faciliter le rebranding (modifier une variable = tout le site)
- Supporter le mode sombre (dark mode) facilement
- Assurer la cohÃ©rence visuelle sur tout le site

### Couleurs

| Variable | Hex | Usage |
|----------|-----|-------|
| `--color-primary` | `#0073e6` | Actions principales |
| `--color-secondary` | `#6c757d` | Actions secondaires |
| `--color-success` | `#28a745` | SuccÃ¨s, en stock |
| `--color-warning` | `#ffc107` | Alertes |
| `--color-danger` | `#dc3545` | Erreurs, soldes |
| `--color-dark` | `#1a1a2e` | Texte principal |
| `--color-light` | `#f8f9fa` | ArriÃ¨re-plans |

### Typographie

| Ã‰lÃ©ment | Font | Size | Weight |
|---------|------|------|--------|
| H1 | Inter | 2.5rem | 700 |
| H2 | Inter | 2rem | 600 |
| H3 | Inter | 1.5rem | 600 |
| Body | Inter | 1rem | 400 |
| Small | Inter | 0.875rem | 400 |
| Price | Inter | 1.25rem | 700 |

### Espacements

```css
--spacing-xs: 0.25rem;  /* 4px */
--spacing-sm: 0.5rem;   /* 8px */
--spacing-md: 1rem;     /* 16px */
--spacing-lg: 1.5rem;   /* 24px */
--spacing-xl: 2rem;     /* 32px */
--spacing-2xl: 3rem;    /* 48px */
```

## ğŸ”„ Workflow de dÃ©veloppement

### Mode dÃ©veloppement

```bash
# DÃ©sactiver l'agrÃ©gation CSS/JS via Drush
drush state:set system.performance css_preprocess 0 --input-format=string
drush state:set system.performance js_preprocess 0 --input-format=string
```

**Activer le dÃ©bogage Twig** dans `sites/default/services.yml` :

```yaml
parameters:
  twig.config:
    debug: true
    auto_reload: true
    cache: false
```

:::caution[âš ï¸ Mode dÃ©veloppement uniquement]
Cette configuration doit Ãªtre dÃ©sactivÃ©e en production pour des raisons de performance.
Le dÃ©bogage Twig gÃ©nÃ¨re des commentaires HTML volumineux.
:::

```bash
# Vider le cache aprÃ¨s modification
drush cr
```

### RafraÃ®chir aprÃ¨s modification

```bash
# Cache des templates
drush cr

# Cache des CSS (si agrÃ©gation activÃ©e)
drush cc css-js
```

## ğŸ› ï¸ Outils recommandÃ©s

### Extensions VS Code

- **Drupal Syntax Highlighting**
- **Twig Language 2**
- **Tailwind CSS IntelliSense**
- **Alpine.js IntelliSense**

### Inspection du DOM

1. Activez le dÃ©bogage Twig
2. Inspectez le HTML source pour voir :
   - Les suggestions de templates
   - Les variables disponibles
   - Les chemins des fichiers

```html
<!-- THEME DEBUG -->
<!-- THEME HOOK: 'node' -->
<!-- FILE NAME SUGGESTIONS:
   * node--product--full.html.twig
   * node--product.html.twig
   * node--1.html.twig
   * node.html.twig
-->
<!-- BEGIN OUTPUT from 'themes/custom/tailstore/templates/node/node--product.html.twig' -->
```

## ğŸ“Š Composants Ã  crÃ©er (par ordre de dÃ©veloppement)

**StratÃ©gie** : Commencer par les composants de base (header, footer), puis les Ã©lÃ©ments de contenu (produits), et enfin les interactions avancÃ©es (slider, panier dynamique).

| PrioritÃ© | Composant | Template | DifficultÃ© | Ã‰tape | Temps |
|----------|-----------|----------|------------|-------|-------|
| ğŸ”´ 1 | Header + Logo | `block--system-branding-block.html.twig` | â­ Facile | 6.1-6.2 | 30min |
| ğŸ”´ 2 | Footer | `region--footer.html.twig` | â­ Facile | 6.2 | 30min |
| ğŸ”´ 3 | Product Card | `node--product--card.html.twig` | â­â­ Moyen | 6.2 | 1h |
| ğŸŸ  4 | Product Teaser | `node--product--teaser.html.twig` | â­â­ Moyen | 6.2 | 45min |
| ğŸŸ  5 | Homepage Layout | `page--front.html.twig` | â­â­ Moyen | 6.4 | 1h30 |
| ğŸŸ  6 | Shop/Catalog | `page--shop.html.twig` | â­â­ Moyen | 6.4 | 1h |
| ğŸŸ¡ 7 | Mega Menu | `menu--main.html.twig` | â­â­â­ Difficile | 6.5 | 2h |
| ğŸŸ¡ 8 | Hero Slider | `block--hero-banner.html.twig` | â­â­â­ Difficile | 6.5 | 2h |
| ğŸŸ¢ 9 | Cart Icon (dynamique) | `block--cart-summary.html.twig` | â­â­â­ Difficile | 6.5 | 1h30 |
| ğŸ”µ 10 | Fiche produit complÃ¨te | `node--product--full.html.twig` | â­â­â­â­ Expert | 6.2-6.5 | 2h |

**LÃ©gende prioritÃ©s** :
- ğŸ”´ PrioritÃ© haute â€” Fondations du thÃ¨me (commencer par lÃ )
- ğŸŸ  PrioritÃ© moyenne â€” Contenu principal (aprÃ¨s les bases)
- ğŸŸ¡ PrioritÃ© basse â€” FonctionnalitÃ©s avancÃ©es (quand le reste fonctionne)
- ğŸ”µ Bonus/Expert â€” FonctionnalitÃ©s complexes (si temps disponible)

## ï¿½ SpÃ©cificitÃ©s e-commerce (Drupal Commerce)

### Distinction importante

Ce thÃ¨me doit gÃ©rer **deux types d'entitÃ©s diffÃ©rentes** :

#### 1. Contenus Drupal classiques (Nodes)
- **Articles de blog** : `node--article.html.twig`
- **Pages statiques** : `node--page.html.twig`
- Templates dans : `templates/node/`

#### 2. EntitÃ©s Drupal Commerce
- **Commerce Products** : Fiches produits avec variations, prix, stock
- **Orders** : Panier, commandes, historique
- **Checkout Flow** : Tunnel de paiement

:::caution[âš ï¸ Attention : Products â‰  Nodes]
Dans Drupal Commerce, les **produits ne sont PAS des nodes** mais des entitÃ©s `commerce_product`.

Templates spÃ©cifiques :
```
templates/commerce/
â”œâ”€â”€ commerce-product.html.twig
â”œâ”€â”€ commerce-product--default.html.twig
â”œâ”€â”€ commerce-product--teaser.html.twig
â”œâ”€â”€ commerce-cart-block.html.twig
â”œâ”€â”€ commerce-checkout-flow.html.twig
â””â”€â”€ commerce-order-receipt.html.twig
```
:::

### Parcours utilisateur e-commerce

```
1. Homepage â†’ 2. Catalogue â†’ 3. Fiche produit â†’ 4. Panier â†’ 5. Checkout â†’ 6. Confirmation
   (page.html)   (views)       (commerce-product)   (cart)      (checkout)   (order-receipt)
```

Chaque Ã©tape nÃ©cessite des templates et styles spÃ©cifiques.

## ğŸš¨ Erreurs courantes Ã  Ã©viter

### âŒ Erreur 1 : Oublier de vider le cache
**SymptÃ´me** : Modifications CSS/Twig non visibles dans le navigateur  
**Solution** : `drush cr` aprÃ¨s **CHAQUE** modification de template ou CSS  
ğŸ’¡ **Astuce** : En mode dev avec `cache: false`, seul le cache de routing nÃ©cessite un flush

### âŒ Erreur 2 : MÃ©langer Tailwind et CSS custom
**ProblÃ¨me** : Conflits entre utility classes et CSS personnalisÃ©  
**Bonne pratique** : Utiliser Tailwind Ã  95%, CSS custom pour &lt;5% des cas exceptionnels  
**Exemple valide** : Animations complexes, reset CSS spÃ©cifique

### âŒ Erreur 3 : Modifier les templates du core
**Danger** : Modifications perdues lors des mises Ã  jour Drupal  
**Bonne pratique** : TOUJOURS copier les templates dans `themes/custom/tailstore/templates/`  
**Jamais** : Modifier directement dans `core/themes/` ou `modules/contrib/`

### âŒ Erreur 4 : Template trop gÃ©nÃ©rique
**ProblÃ¨me** : `node.html.twig` s'applique Ã  TOUS les types de contenu  
**Bonne pratique** : Utiliser les suggestions spÃ©cifiques :  
- âœ… `node--product--full.html.twig` (type + mode d'affichage)  
- âœ… `node--product.html.twig` (type de contenu)  
- âŒ `node.html.twig` (trop large)

### âŒ Erreur 5 : Ignorer le responsive
**ProblÃ¨me** : Site cassÃ© sur mobile/tablette  
**Bonne pratique** : Tester sur plusieurs tailles (F12 â†’ Toggle Device Toolbar)  
**Points de rupture Tailwind** : `sm:` (640px), `md:` (768px), `lg:` (1024px), `xl:` (1280px)

### âŒ Erreur 6 : Charger tous les assets globalement
**ProblÃ¨me** : 200KB de JS/CSS sur toutes les pages, mÃªme inutiles  
**Bonne pratique** : Charger conditionnellement via `hook_preprocess_HOOK()`  
Exemple : Slider JS uniquement sur la homepage

## ğŸ¯ Mission finale de cette Ã©tape

Ã€ la fin de l'Ã©tape 6, vous devrez avoir rÃ©alisÃ© :

### Livrables obligatoires

- [ ] **ThÃ¨me fonctionnel** : Structure complÃ¨te avec `tailstore.info.yml` et `tailstore.libraries.yml`
- [ ] **3 templates Twig personnalisÃ©s** : Au minimum header, product card, footer
- [ ] **Tailwind CSS intÃ©grÃ©** : Configuration fonctionnelle avec purge activÃ©
- [ ] **1 interaction Alpine.js** : Menu mobile, modale, ou panier dynamique
- [ ] **Homepage stylisÃ©e** : Reprenant visuellement le template TailStore

### CritÃ¨res de validation

âœ… **Fonctionnel** : Le site affiche correctement tous les contenus  
âœ… **Responsive** : Mise en page adaptÃ©e mobile/tablette/desktop  
âœ… **Performance** : CSS &lt; 100KB, pas de JS inutile chargÃ©  
âœ… **Code propre** : Templates commentÃ©s, structure logique  
âœ… **Debug dÃ©sactivÃ©** : Pas de `{{ dump() }}` oubliÃ© dans les templates

### ğŸ’¡ Checkpoint de progression

AprÃ¨s chaque sous-Ã©tape, vÃ©rifiez :

| Sous-Ã©tape | RÃ©sultat visible |
|------------|------------------|
| 6.1 CrÃ©ation thÃ¨me | ThÃ¨me activable dans l'admin, logo affichÃ© |
| 6.2 Twig | Header et footer personnalisÃ©s visibles |
| 6.3 Assets | CSS chargÃ© (inspecter le `<head>`) |
| 6.4 Tailwind | Classes Tailwind appliquÃ©es (ex: `bg-blue-500` fonctionne) |
| 6.5 Alpine.js | Menu mobile ou interaction fonctionnelle |

## ğŸ§  Bonnes pratiques essentielles

### ğŸ”’ SÃ©curitÃ© Twig

:::caution[âš ï¸ Ã‰chappement automatique]
Twig Ã©chappe automatiquement toutes les variables pour prÃ©venir les attaques XSS.

**Ne JAMAIS utiliser** `{{ variable|raw }}` sauf si vous Ãªtes **absolument certain** du contenu.

**PrÃ©fÃ©rer** :
```twig
{{ content.field_body }}  {# Ã‰chappe automatiquement #}
{{ content }}             {# Rendu Drupal sÃ©curisÃ© #}
```

**Ã‰viter** :
```twig
{{ unsafe_html|raw }}     {# Danger XSS ! #}
```
:::

### âš¡ Performance

:::tip[ğŸ’¡ Optimisation Tailwind]
**ProblÃ¨me** : Tailwind gÃ©nÃ¨re 3MB+ de CSS en mode dÃ©veloppement.

**Solution** : Configurer le **purge** pour supprimer les classes inutilisÃ©es en production.

**Objectif** : &lt; 50KB de CSS final aprÃ¨s purge et minification.

**Configuration dans `tailwind.config.js`** :
```js
module.exports = {
  content: [
    './templates/**/*.twig',
    './js/**/*.js',
  ],
  // ... autres configs
}
```

Le purge analyse vos fichiers et ne garde que les classes utilisÃ©es.
:::

### â™¿ AccessibilitÃ© (WCAG)

:::note[â™¿ Checklist accessibilitÃ©]
Chaque composant crÃ©Ã© **DOIT** respecter :

âœ… **Contraste** : Minimum WCAG AA (4.5:1 pour texte normal, 3:1 pour texte large)  
âœ… **Navigation clavier** : Tab, Enter, Esc fonctionnels  
âœ… **Attributs ARIA** : `aria-label`, `role`, `aria-expanded` quand nÃ©cessaire  
âœ… **Ordre des headings** : h1 â†’ h2 â†’ h3 (pas de saut de niveau)  
âœ… **Images** : Attribut `alt` obligatoire (description ou `alt=""` si dÃ©corative)

**Outils de test** :
- Extension Chrome/Firefox : [axe DevTools](https://www.deque.com/axe/devtools/)
- Lecteur d'Ã©cran : NVDA (Windows), JAWS, VoiceOver (Mac)
- VÃ©rificateur de contraste : [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)
:::

## ğŸ¨ Ressources et inspirations

### ThÃ¨mes Drupal Ã  Ã©tudier

- **Olivero** (thÃ¨me par dÃ©faut Drupal 10/11) : SystÃ¨me de tokens CSS moderne
- **Claro** (admin theme) : Composants UI accessibles
- **Gin** (contrib) : Interface admin moderne avec design system

### Librairies CSS/JS recommandÃ©es

- [**Tailwind UI**](https://tailwindui.com/) : Composants e-commerce prÃªts Ã  l'emploi (payant)
- [**Flowbite**](https://flowbite.com/) : Composants Tailwind + Alpine.js (gratuit)
- [**DaisyUI**](https://daisyui.com/) : Framework de composants basÃ© sur Tailwind
- [**Headless UI**](https://headlessui.com/) : Composants accessibles sans style (Ã  combiner avec Tailwind)

### Documentation technique

- [Twig Documentation](https://twig.symfony.com/doc/) : RÃ©fÃ©rence complÃ¨te du moteur de template
- [Drupal Twig Functions](https://drupal.org/docs/theming-drupal/twig-in-drupal) : Fonctions et filtres Drupal
- [Drupal Theme System](https://www.drupal.org/docs/theming-drupal) : Guide officiel theming
- [Tailwind CSS v4 Docs](https://tailwindcss.com/docs) : Documentation officielle Tailwind

### Outils de dÃ©veloppement

**Extensions VS Code recommandÃ©es** :
- **Drupal Syntax Highlighting** : Coloration syntaxique Drupal
- **Twig Language 2** : Support Twig avec autocomplÃ©tion
- **Tailwind CSS IntelliSense** : AutocomplÃ©tion classes Tailwind
- **Alpine.js IntelliSense** : Support Alpine.js

## ğŸš€ C'est parti !

Vous avez maintenant une vision complÃ¨te de l'Ã©tape 6. Commencez par [CrÃ©er le thÃ¨me](/etape-6-theming/creation-theme/).
