---
title: Installation avec Composer
description: Comprendre et utiliser Composer pour gÃ©rer un projet Drupal 11
sidebar:
  order: 3

# status: draft
# last-reviewed: 2025-12-10
---

import { Steps } from '@astrojs/starlight/components';

Composer est le gestionnaire de dÃ©pendances standard pour PHP. C'est l'outil **obligatoire** pour installer et maintenir un projet Drupal 11 moderne.

## ğŸ¤” Pourquoi Composer ?

### Avant Composer (Drupal 7 et avant)

- TÃ©lÃ©chargement manuel des modules depuis drupal.org
- Gestion manuelle des mises Ã  jour
- Conflits de dÃ©pendances frÃ©quents
- Pas de versionnement des dÃ©pendances

### Avec Composer (Drupal 8+)

- âœ… Installation automatique des modules et leurs dÃ©pendances
- âœ… Mises Ã  jour simples avec une seule commande
- âœ… Versions verrouillÃ©es dans `composer.lock`
- âœ… ReproducibilitÃ© parfaite entre environnements
- âœ… Autoloading PSR-4 automatique

## ğŸ“¦ Les fichiers Composer

### composer.json

Le fichier de configuration principal qui dÃ©crit votre projet :

```json
{
    "name": "drupal/recommended-project",
    "description": "Project template for Drupal projects",
    "type": "project",
    "license": "GPL-2.0-or-later",
    "require": {
        "drupal/core-recommended": "^11.0",
        "drupal/core-composer-scaffold": "^11.0",
        "drush/drush": "^13.0"
    },
    "require-dev": {
        "drupal/core-dev": "^11.0"
    },
    "extra": {
        "drupal-scaffold": {
            "locations": {
                "web-root": "web/"
            }
        },
        "installer-paths": {
            "web/core": ["type:drupal-core"],
            "web/modules/contrib/{$name}": ["type:drupal-module"],
            "web/themes/contrib/{$name}": ["type:drupal-theme"],
            "web/profiles/contrib/{$name}": ["type:drupal-profile"]
        }
    }
}
```

#### Sections importantes

| Section | Description |
|---------|-------------|
| `require` | DÃ©pendances de production |
| `require-dev` | DÃ©pendances de dÃ©veloppement uniquement |
| `extra.installer-paths` | OÃ¹ installer les packages Drupal |
| `extra.drupal-scaffold` | Configuration du scaffolding |

### composer.lock

Fichier gÃ©nÃ©rÃ© automatiquement qui verrouille les versions exactes de toutes les dÃ©pendances.

:::caution[Important]
**Toujours commiter** `composer.lock` dans Git ! Il garantit que tous les dÃ©veloppeurs utilisent les mÃªmes versions.
:::

## ğŸ› ï¸ Commandes Composer essentielles

### CrÃ©er un nouveau projet

```bash
composer create-project drupal/recommended-project:^11.0 mon-projet
```

- `drupal/recommended-project` : Template officiel Drupal
- `^11.0` : Version 11.x (derniÃ¨re version 11)

### Installer les dÃ©pendances

```bash
# Installer depuis composer.lock (recommandÃ© en production)
composer install

# Mettre Ã  jour les dÃ©pendances selon composer.json
composer update
```

### Ajouter un module

```bash
# Ajouter un module Drupal
composer require drupal/pathauto

# Ajouter une version spÃ©cifique
composer require drupal/pathauto:^1.12

# Ajouter en dev uniquement
composer require --dev drupal/devel
```

### Mettre Ã  jour

```bash
# Mettre Ã  jour tout
composer update

# Mettre Ã  jour un package spÃ©cifique
composer update drupal/core-recommended --with-dependencies

# Voir les mises Ã  jour disponibles
composer outdated
```

### Supprimer un package

```bash
composer remove drupal/pathauto
```

### Commandes utiles

```bash
# Afficher les packages installÃ©s
composer show

# Afficher un package spÃ©cifique
composer show drupal/core

# VÃ©rifier les problÃ¨mes
composer diagnose

# Vider le cache Composer
composer clear-cache
```

## ğŸ”’ Versionnement sÃ©mantique

Composer utilise le [versionnement sÃ©mantique](https://semver.org/) :

```
MAJOR.MINOR.PATCH
  11  .  0  .  1
```

| PrÃ©fixe | Signification | Exemple |
|---------|---------------|---------|
| `^` | Compatible MAJOR | `^11.0` â†’ 11.x.x |
| `~` | Compatible MINOR | `~11.0.1` â†’ 11.0.x |
| `>=` | Version minimale | `>=11.0` |
| `*` | N'importe quelle version | Non recommandÃ© |

:::tip[Recommandation]
Utilisez `^` (caret) pour la plupart des packages : `^11.0` acceptera les mises Ã  jour mineures et de patch.
:::

## ğŸ“ Structure aprÃ¨s installation

```
tailstore/
â”œâ”€â”€ composer.json         # Configuration du projet
â”œâ”€â”€ composer.lock         # Versions verrouillÃ©es
â”œâ”€â”€ vendor/               # DÃ©pendances (NE PAS MODIFIER)
â”‚   â”œâ”€â”€ autoload.php     # Autoloader gÃ©nÃ©rÃ©
â”‚   â”œâ”€â”€ composer/
â”‚   â”œâ”€â”€ drupal/
â”‚   â””â”€â”€ ...
â”œâ”€â”€ web/                  # Racine web
â”‚   â”œâ”€â”€ core/            # Drupal core
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ contrib/     # Modules tÃ©lÃ©chargÃ©s
â”‚   â”‚   â””â”€â”€ custom/      # Vos modules
â”‚   â”œâ”€â”€ themes/
â”‚   â”‚   â”œâ”€â”€ contrib/     # ThÃ¨mes tÃ©lÃ©chargÃ©s
â”‚   â”‚   â””â”€â”€ custom/      # Vos thÃ¨mes
â”‚   â””â”€â”€ sites/
â””â”€â”€ config/
    â””â”€â”€ sync/            # Configuration exportÃ©e
```

## ğŸ¯ Installer les modules essentiels

Pour notre projet TailStore, installons les modules de base :

```bash
# Dans le dossier du projet
cd tailstore

# Modules contributifs essentiels
composer require drupal/admin_toolbar
composer require drupal/pathauto
composer require drupal/token
composer require drupal/webform
composer require drupal/metatag

# Module de dÃ©veloppement
composer require --dev drupal/devel
```

## ğŸ”„ Workflow quotidien

<Steps>

1. **RÃ©cupÃ©rer le code** (si vous travaillez en Ã©quipe)
   ```bash
   git pull
   composer install
   drush updb -y
   drush cim -y
   drush cr
   ```

2. **Ajouter une fonctionnalitÃ©**
   ```bash
   composer require drupal/nouveau_module
   drush en nouveau_module -y
   drush cex -y
   git add -A
   git commit -m "feat: add nouveau_module"
   ```

3. **Mettre Ã  jour Drupal**
   ```bash
   composer update drupal/core-recommended --with-dependencies
   drush updb -y
   drush cr
   # Tester le site
   git add -A
   git commit -m "chore: update Drupal core"
   ```

</Steps>

## âš ï¸ Bonnes pratiques

### Ã€ faire âœ…

- Commiter `composer.json` ET `composer.lock`
- Utiliser `composer install` en production
- Verrouiller les versions majeures (`^11.0`)
- Tester aprÃ¨s chaque `composer update`

### Ã€ Ã©viter âŒ

- Ne jamais modifier les fichiers dans `vendor/`
- Ne pas commiter le dossier `vendor/`
- Ne pas utiliser `composer update` en production
- Ne pas mÃ©langer tÃ©lÃ©chargements manuels et Composer

## ğŸ› RÃ©solution de problÃ¨mes

### Conflit de dÃ©pendances

```bash
# Voir les conflits
composer why-not drupal/some-module

# Forcer une mise Ã  jour
composer update --with-all-dependencies
```

### MÃ©moire insuffisante

```bash
# Augmenter la limite mÃ©moire pour cette commande
php -d memory_limit=-1 /usr/local/bin/composer update
```

### Cache corrompu

```bash
composer clear-cache
rm -rf vendor
composer install
```

## âœ… Exercice pratique

Installez les modules suivants avec Composer :

1. `drupal/admin_toolbar` - Barre d'administration amÃ©liorÃ©e
2. `drupal/pathauto` - URLs automatiques
3. `drupal/token` - Jetons pour pathauto
4. `drupal/metatag` - MÃ©ta-tags SEO

Commandes :

```bash
composer require drupal/admin_toolbar drupal/pathauto drupal/token drupal/metatag
```

VÃ©rifiez avec :

```bash
composer show drupal/*
```

## ğŸš€ Ã‰tape suivante

Passez Ã  la [Structure des fichiers](/etape-1-installation/structure-fichiers/) pour comprendre l'organisation d'un projet Drupal.
